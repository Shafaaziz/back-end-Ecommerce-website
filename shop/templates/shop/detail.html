{% extends 'base.html' %}
{% load static %}

{% block links %}
<link rel="stylesheet" href="{% static 'shop/detail.css' %}">
<link rel="stylesheet" href="{% static 'shop/comment.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock %}
{% block title %}جزئیات محصول{% endblock %}


{% block body %}

<main class="container">
 
    <!-- Left Column / Headphones Image -->
    <div class="left-column">
      <img data-image="black" src="{{ product.image.url }}" >
    </div>
   
   
    <!-- Right Column -->
    <div class="right-column">
   
      <!-- Product Description -->
      <div class="product-description">
        <span>{{category}}</span>
        <h1>{{product.name}}</h1>
      </div>
      <p>{{ product.information }}</p>
      <div>
        {% if product.status == 'سایز' %}
          <form method="POST" style="display: flex;">
            {% csrf_token %}
            <h5 style="margin-left: 10px; margin-top: 10px;">  سایز:</h5>
            <select style="background-color: darkcyan; border-radius: 10%; border: 1px solid;" name="size" id="size">
            {% for data in variant %}
              <option value="{{data.id}}" {% if variants.id == data.id %} checked{% endif %} name="selected" onchange="this.form.submit();">{{data.size_variant}}</option>
            {% endfor %}
            </select>            
          </form>
        {% endif %}

      <div class="product-price">
        <span>قیمت: {{product.price}} تومان</span>
        <a href="#" class="cart-btn"> سبد خرید</a>
      </div>


      <small>{{product.total_like}}</small>
        {% if is_like %}
          <a href="{% url 'product_like' product.id %}" class="btn {% if is_unlike %} disabled {% endif %}" style="border: none;"><i class="fa fa-thumbs-up" style="color: red; font-size:24px"></i></a>
        {% else %}
          <a href="{% url 'product_like' product.id %}" class="btn {% if is_unlike %} disabled {% endif %}" style="border: none;"><i class="fa fa-thumbs-up" style="color: gray; font-size:24px"></i></a>
        {% endif %}

        <small>{{product.total_unlike}}</small>
        {% if is_unlike %}
          <a href="{% url 'product_unlike' product.id %}" class="btn {% if is_like %} disabled {% endif %}" style="border: none;" ><i class="fa fa-thumbs-down" style="color: black; font-size:24px"></i></a>
        {% else %}
          <a href="{% url 'product_unlike' product.id %}" class="btn {% if is_like %} disabled {% endif %}" style="border: none;"><i class="fa fa-thumbs-down" style="color: gray; font-size:24px"></i></a>
        {% endif %}
      </div>
      <!-- Comment Form -->
      {% for comment in comment %}
      <p>{{comment.comment}}</p>
      <small>{{comment.rate}}</small>
      {% endfor %}
      <div class="row comment">
        <div class="col-6">
          <form method="POST" action="{% url 'product_comment' product.id %}">
            {% csrf_token %}
            <div class="card">
              <div class="row">
                <div class="col-12">
                  <div class="comment-box">
                    <h4>Add comment</h4>
                    <div class="rating">
                      <input type="radio" name="rate" value="5" id="5"><label for="5">&star;</label>
                      <input type="radio" name="rate" value="4" id="4"><label for="4">&star;</label>
                      <input type="radio" name="rate" value="3" id="3"><label for="3">&star;</label>
                      <input type="radio" name="rate" value="2" id="2"><label for="2">&star;</label>
                      <input type="radio" name="rate" value="1" id="1"><label for="1">&star;</label>
                    </div>
                    <div class="comment-box">
                      <textarea name="comment" class="form-control" rows="4" required oninvalid="setCustomValidity('!نظری درج نشده است')"></textarea>
                    </div>
                    <div class="text-right me-1">
                      <button type="submit" class="btn btn-danger">ثبت</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form> 
        </div>
      </div>
    <div>
    {% for comment in comment %}
      <div class="card bg-dark text-white">
        <div class="row">
          <div class="col-8">
            <p style="font-weight: 800;">{{comment.user.username}} :</p>
          </div>
          <div class="col-4">
            <div class="comment-rating">
              <i class="fa fa-star {% if coment.rate < 1 %}-o empty {% endif %}"></i>
              <i class="fa fa-star {% if coment.rate < 2 %}-o empty {% endif %}"></i>
              <i class="fa fa-star {% if coment.rate < 3 %}-o empty {% endif %}"></i>
              <i class="fa fa-star {% if coment.rate < 4 %}-o empty {% endif %}"></i>
              <i class="fa fa-star {% if coment.rate < 5 %}-o empty {% endif %}"></i>
            </div>
          </div>
        </div>
        <div class="row">
          <p>{{comment.comment}}</p>
        </div>
        <form method="POST" action="{% url 'comment_reply' product.id comment.id %}">
          {% csrf_token %}
          <textarea name="comment" id="comment" class="form-control" rows="4" placeholder="پاسخ" required oninvalid="setCustomValidity('!نظری درج نشده است')"></textarea>
          <class class="mt-2">
            <button type="submit" class="btn btn-danger">ثبت</button>
          </class>
        </form>
        {% for data in comment.comment_reply.all %}
          <div class="bg-info mt-2 p-2">
            <h6 style="color: black; font-weight: 800;">{{comment.user.username}} :</h6>
            <p>{{data.comment}}</p>
          </div>
        {% endfor%}
      </div>
    {% endfor %}
      
    </div>
  </main>

{% endblock %}
